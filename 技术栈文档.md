# Word Count Pro - 技术栈文档

## 📋 项目概述

这是一个优雅高效的文档字数统计工具，支持 Word、PDF、TXT、Markdown 等多种文档格式的批量字数统计，并提供 Excel 和 PDF 格式的导出功能。

---

## 🎨 前端技术栈

### 核心框架
- **Vue.js 3.x** (Composition API)
  - 使用 CDN 引入：`vue.global.js`
  - 采用 Composition API (`setup()`, `ref()`, `computed()`)
  - 响应式状态管理

### UI 框架与样式
- **Tailwind CSS** (通过 CDN 引入)
  - JIT 模式
  - 自定义主题配置
  - 响应式设计（移动端适配）
  - 自定义颜色主题（`primary: #007AFF`）

- **Google Fonts**
  - 字体：Inter (400, 500, 600, 700)
  - 优化排版体验

### CSS 设计技术
- **现代设计特性**
  - Glassmorphism（毛玻璃效果）
  - Backdrop Filter（背景模糊效果）
  - 渐变色背景（Radial Gradient）
  - 自定义动画（Slide Up, Fade In）
  - 阴影效果（Shadow）

- **自定义动画**
  ```css
  - slideUp：入场动画
  - fadeIn：淡入动画
  - 自定义 cubic-bezier 缓动函数
  ```

### JavaScript 特性
- **现代 ES6+ 语法**
  - Async/Await
  - Promise
  - Arrow Functions
  - Destructuring
  - Template Literals
  - Spread Operator

- **文件处理 API**
  - File API
  - FileReader API
  - Drag & Drop API
  - FormData API
  - Blob API
  - webkitdirectory（文件夹上传）
  - webkitGetAsEntry（递归目录扫描）

### 前端功能特性
- ✅ 拖拽上传（Drag & Drop）
- ✅ 文件选择器（File Input）
- ✅ 文件夹递归扫描
- ✅ 文件类型过滤（.docx, .pdf, .txt, .md）
- ✅ 实时统计（计数、总字数）
- ✅ 分类筛选（全部、Markdown、Text、PDF、Word）
- ✅ 排序功能（升序、降序、默认）
- ✅ 响应式布局
- ✅ 加载状态动画
- ✅ 错误提示
- ✅ Excel/PDF 导出

---

## 🔧 后端技术栈

### 核心框架
- **FastAPI** (现代 Python Web 框架)
  - 高性能 ASGI 异步框架
  - 自动 API 文档生成 (OpenAPI/Swagger)
  - Pydantic 数据验证
  - 原生类型提示支持
  - RESTful API 设计

### ASGI 服务器
- **Uvicorn**
  - 超快速的 ASGI 服务器
  - 支持 HTTP/1.1 和 WebSocket
  - 生产级性能

### Python 版本
- **Python 3.9+**

### 文档处理库

#### Word 文档处理
- **python-docx**
  - 读取 .docx 文件
  - 段落文本提取
  - 表格内容提取

#### PDF 文档处理
- **PyPDF2**
  - PDF 文本提取
  - 多页面处理

#### 文本文件处理
- **内置 Python 库**
  - 多编码支持：UTF-8, GBK, GB2312, UTF-16, Latin-1
  - 自动编码检测
  - 支持 .txt 和 .md 文件

### Excel 导出
- **openpyxl**
  - Excel 文件生成
  - 单元格样式（字体、填充、对齐、边框）
  - 自动列宽调整
  - 表头样式定制

### PDF 导出
- **ReportLab**
  - PDF 文档生成
  - 中文字体支持（PingFang、STHeiti）
  - 表格样式
  - 段落样式
  - 页面布局（A4）

### 后端功能特性
- ✅ 多格式文档解析（Word, PDF, TXT, Markdown）
- ✅ 字符统计（去除空格、换行、制表符）
- ✅ 文件夹扫描
- ✅ 文件上传处理（临时目录管理）
- ✅ Excel 报表生成
- ✅ PDF 报表生成
- ✅ 错误处理与状态反馈
- ✅ 自动打开浏览器
- ✅ 中文字体支持（macOS）

### API 接口设计

#### 1. 主页
```
GET /
返回：HTML 页面
```

#### 2. 文件夹分析
```
POST /api/analyze
请求：{ folder_path: string }
响应：{ results: [], count: number }
```

#### 3. 文件上传分析
```
POST /api/analyze_upload
请求：FormData (files[])
响应：{ results: [], count: number }
```

#### 4. Excel 导出
```
POST /api/export/excel
请求：{ results: [] }
响应：Excel 文件流
```

#### 5. PDF 导出
```
POST /api/export/pdf
请求：{ results: [] }
响应：PDF 文件流
```

---

## 📦 打包与部署

### 桌面应用打包
- **PyInstaller**
  - 单文件打包（`--onefile`）
  - 窗口模式（`--windowed`）
  - 静态资源打包（`--add-data`）
  - 隐藏导入（`--hidden-import`）

### CI/CD 自动化
- **GitHub Actions**
  - 多平台构建（Windows, macOS）
  - 自动发布（Release）
  - 构建产物上传
  - Tag 触发构建

### 支持平台
- ✅ Windows
- ✅ macOS (Intel & Apple Silicon)

---

## 📁 项目结构

```
word-count/
├── templates/                      # 模板目录
│   └── index.html                 # 主页面(Vue.js 单页应用)
├── static/                        # 静态资源目录
│   ├── script.js                  # Vue.js 应用逻辑
│   └── style.css                  # 自定义样式
├── .github/
│   └── workflows/
│       └── build.yml              # GitHub Actions 配置
├── word_count_fastapi.py          # FastAPI 主应用(当前版本)
├── word_count_web_flask_backup.py # Flask 归档版本
├── create_pdf.py                  # PDF 生成工具
├── requirements.txt               # Python 依赖
├── Word字数统计.spec               # PyInstaller 配置
├── 启动FastAPI.command            # macOS FastAPI 启动脚本
├── 启动程序.bat                   # Windows 启动脚本
├── 启动程序.command               # macOS Flask 启动脚本
├── 打包Mac应用.sh                 # macOS 打包脚本
├── 打包Windows应用.bat            # Windows 打包脚本
└── 技术栈文档.md                  # 本文档
```

---

## 🎯 核心技术亮点

### 1. 前端体验优化
- **渐进式增强**：优雅的加载动画和错误处理
- **交互反馈**：拖拽悬停效果、按钮状态变化
- **视觉设计**：毛玻璃效果、渐变色、微动画
- **响应式设计**：移动端适配

### 2. 后端性能优化
- **多编码支持**：自动检测文件编码
- **临时文件管理**：自动清理上传的临时文件
- **错误容错**：完善的异常处理机制
- **内存优化**：使用 BytesIO 处理文件流

### 3. 用户体验设计
- **零配置启动**：自动打开浏览器
- **批量处理**：支持文件夹递归扫描
- **智能过滤**：多维度筛选和排序
- **一键导出**：Excel 和 PDF 双格式支持

### 4. 跨平台兼容性
- **操作系统**：Windows 和 macOS 原生应用
- **浏览器**：现代浏览器全支持
- **文件系统**：路径处理兼容性

---

## 🔐 安全特性

- ✅ 文件类型白名单验证
- ✅ 隐藏文件过滤（`~$` 开头的临时文件）
- ✅ 临时文件自动清理
- ✅ 路径安全处理（引号清理）
- ✅ 错误信息安全提示

---

## 📚 依赖管理

### Python 依赖
```txt
# 后端框架
fastapi          # FastAPI 核心框架
uvicorn[standard] # ASGI 服务器
python-multipart  # 文件上传支持
jinja2           # 模板引擎

# 文档处理
python-docx      # Word 文档处理
PyPDF2           # PDF 处理

# 报表生成
openpyxl         # Excel 生成
reportlab        # PDF 生成

# 开发工具(可选)
pyinstaller      # 应用打包
```

### 前端依赖（CDN）
```html
- Vue.js 3.x
- Tailwind CSS
- Google Fonts (Inter)
```

---

## 🚀 运行方式

### 开发模式

**FastAPI 版本(推荐)**:
```bash
python3 word_count_fastapi.py
# 自动打开浏览器访问 http://127.0.0.1:8000
# API 文档: http://127.0.0.1:8000/docs
```

**Flask 归档版本**:
```bash
python3 word_count_web_flask_backup.py
# 自动打开浏览器访问 http://127.0.0.1:5001
```

### 生产模式
- macOS FastAPI: 双击 `启动FastAPI.command`
- macOS Flask: 双击 `启动程序.command`
- Windows: 双击 `启动程序.bat`

### 打包应用
- Windows: 运行 `打包Windows应用.bat`
- macOS: 运行 `./打包Mac应用.sh`

---

## 📊 技术选型理由

| 技术 | 选型理由 |
|------<|---------|
| **FastAPI** | 现代化高性能框架、自动 API 文档、类型安全、异步支持 |
| **Uvicorn** | 生产级 ASGI 服务器、卓越性能、WebSocket 支持 |
| **Vue.js 3** | 渐进式框架、学习曲线低、Composition API 灵活 |
| **Tailwind CSS** | 快速开发、高度定制、原子化 CSS |
| **PyInstaller** | 成熟的 Python 打包工具、支持多平台 |
| **python-docx** | Word 文档处理的标准库 |
| **ReportLab** | 强大的 PDF 生成能力、中文支持好 |
| **openpyxl** | Excel 文件操作的首选库 |

---

## 🎨 设计规范

### 配色方案
- **主色**：`#007AFF` (iOS 蓝)
- **悬停色**：`#0062CC`
- **背景**：渐变色 + 毛玻璃效果
- **文件类型标签**：
  - Word: 蓝色 (`blue-100/700`)
  - PDF: 红色 (`red-100/700`)
  - TXT: 灰色 (`gray-100/700`)
  - Markdown: 靛蓝 (`indigo-100/700`)

### 字体规范
- **主字体**：Inter
- **等宽字体**：系统默认（用于字数显示）

### 动画时长
- **快速**：200ms (按钮状态)
- **标准**：300ms (一般交互)
- **慢速**：500ms (页面切换)

---

## 🔄 未来扩展方向

基于当前技术栈，可以考虑：

1. **后端增强**
   - 添加更多文档格式支持（如 RTF, ODT）
   - 实现文档内容预览
   - 添加 OCR 图片文字识别

2. **前端优化**
   - 添加深色模式
   - 实现拖拽排序
   - 添加图表可视化

3. **功能扩展**
   - 云端同步
   - 历史记录
   - 批量任务队列

---

**文档生成时间**：2025-11-21  
**项目版本**：1.0  
**维护者**：DeepLifeStudio
