# Word Count Pro

> 优雅高效的多格式文档字数统计工具

一个功能强大、界面精美的文档字数统计工具,支持批量处理多种文档格式,是内容创作者、编辑、学生和职场人士的得力助手。

---

## ✨ 核心特性

### 📚 多格式支持
- **Word 文档** (.docx) - 完整支持页眉、页脚内容统计
- **PDF 文档** (.pdf) - 高精度文本提取
- **Markdown 文件** (.md) - 自动过滤语法符号
- **纯文本文件** (.txt) - 智能编码检测

### 🌏 中英混合智能统计
- **中文字符**：每个汉字计为 1 个字
- **英文单词**：按空格/标点分隔计数
- **自动识别**：无需手动切换,智能处理混合文本

### 🎯 批量处理
- **拖拽上传**：直接拖入文件或整个文件夹
- **便捷续传**：可在现有结果基础上继续添加文件
- **智能筛选**：自动识别支持的文档格式
- **进度显示**：实时查看处理进度

### 📊 强大的数据管理
- **分类筛选**：按文件类型快速筛选结果
- **排序功能**：支持字数升序/降序排列
- **单文件删除**：灵活管理统计列表
- **实时统计**：即时显示总文件数和总字数

### 💾 多格式导出
- **Excel 导出**：生成专业的数据报表,支持样式美化
- **PDF 导出**：打印就绪的精美文档,适合正式场合

---

## 🎬 使用场景

### 📝 内容创作者
- 统计文章、小说章节字数
- 管理多篇稿件的字数配额
- 快速查看创作进度

### 🎓 学生群体
- 检查论文、作业字数要求
- 批量统计课程笔记总量
- 整理学习材料数据

### 💼 职场人士
- 统计项目文档总字数
- 核算翻译、撰稿工作量
- 生成工作量报表

### 📑 编辑出版
- 快速评估稿件篇幅
- 批量处理投稿统计
- 生成字数统计报告

---

## 🚀 快速开始

### 方式一：使用打包应用（推荐）

#### **macOS 用户**
1. 双击 **`Word字数统计.app`** 应用图标
2. 如遇安全提示,右键点击 → 选择"打开"
3. 应用会自动启动并打开浏览器界面

#### **Windows 用户**
1. 双击 **`Word字数统计.exe`** 应用
2. 等待命令行窗口启动(请勿关闭)
3. 浏览器会自动打开使用界面

### 方式二：从源码运行

#### **1. 安装依赖**
```bash
pip install -r requirements.txt
```

#### **2. 启动程序**

**macOS/Linux:**
```bash
./启动程序.command
```

**Windows:**
```bash
启动程序.bat
```

**或直接运行 Python:**
```bash
python word_count_fastapi.py
```

#### **3. 访问界面**
程序启动后会自动打开浏览器,或手动访问:
```
http://127.0.0.1:8000
```

---

## 📖 使用指南

### 上传文件

#### **方法 1: 拖拽上传**（推荐）
- 将文件或文件夹直接拖入上传区域
- 系统会自动扫描并识别支持的文档

#### **方法 2: 点击上传**
- 点击上传区域选择单个或多个文件
- 点击"上传文件夹"按钮批量处理整个目录

### 查看结果

**统计信息卡片**
- 总文件数：当前统计的文档总数
- 总字数：所有文档的字数总和

**文件列表**
- 文件名：显示文档完整名称
- 类型：标注文件格式 (DOCX/PDF/MD/TXT)
- 字数：精确统计结果
- 状态：处理成功或失败标识

### 筛选与排序

**按类型筛选**
- 全部：显示所有文档
- Markdown：仅显示 .md 文件
- 文本：仅显示 .txt 文件
- PDF：仅显示 .pdf 文件
- Word：仅显示 .docx 文件

**字数排序**
- 点击"字数"列标题切换排序
- 降序：从多到少 ↓
- 升序：从少到多 ↑

### 管理文件

**删除单个文件**
- 点击列表中文件行最右侧的删除图标
- 该文件会从统计结果中移除

**继续上传**
- 点击"继续上传"按钮
- 在现有结果基础上追加新文件

**清空重传**
- 点击"清空重传"按钮
- 清除所有结果,重新开始统计

### 导出数据

**导出 Excel**
- 生成 `.xlsx` 格式电子表格
- 包含完整的统计数据和格式
- 适合二次编辑和数据分析

**导出 PDF**
- 生成精美的 `.pdf` 格式报告
- 专业排版,支持直接打印
- 适合正式场合提交

---

## ⚙️ 技术架构

### 后端技术
- **FastAPI** - 高性能异步 Web 框架
- **Uvicorn** - ASGI 服务器
- **python-docx** - Word 文档解析
- **pdfplumber** - PDF 文本提取
- **BeautifulSoup4** - Markdown 内容处理
- **openpyxl** - Excel 文件生成
- **ReportLab** - PDF 报表生成

### 前端技术
- **Vue.js 3** - 响应式前端框架
- **Tailwind CSS** - 现代化 UI 样式系统
- **原生 JavaScript** - 文件处理逻辑

### 特色功能
- **智能编码检测** (chardet) - 自动识别文本文件编码
- **批量异步处理** - 高效处理大量文档
- **实时进度反馈** - 透明的处理进度显示

---

## ⚠️ 重要说明

### 文件格式限制

**✅ 支持格式**
- `.docx` - Word 2007 及更高版本
- `.pdf` - 标准 PDF 文档
- `.md` - Markdown 文档
- `.txt` - 纯文本文件

**❌ 不支持格式**
- `.doc` - Word 2003 旧版格式（需转换为 .docx）

**如何转换 .doc 文件:**
1. 使用 Microsoft Word 打开 .doc 文件
2. 点击 "文件" → "另存为"
3. 选择保存类型为 "Word 文档 (*.docx)"
4. 保存后即可正常统计

### 字数统计逻辑

本工具采用**混合字数统计算法**:

- **中文/日文/韩文 (CJK) 字符**：每个字符计为 1 字
- **英文/数字/其他语言**：以空格和标点符号分隔的单词,每个单词计为 1 字
- **标点符号**：跟随所在语言规则
- **空格/换行/制表符**：不计入字数

**示例:**
```
文本: "这是一个测试 This is a test"
统计结果: 10 字
说明: 5个中文字符 + 4个英文单词 + 1个英文单词 = 10
```

---

## 🐛 常见问题

### Q1: 双击应用无法启动怎么办?

**macOS 系统:**
1. 右键点击应用 → 选择"打开"
2. 在弹出的警告中点击"打开"确认
3. 或在"系统偏好设置" → "安全性与隐私"中允许

**Windows 系统:**
1. 确保已关闭防火墙对程序的拦截
2. 以管理员身份运行应用

### Q2: 提示端口被占用怎么办?

**macOS/Linux:**
```bash
lsof -ti :8000 | xargs kill -9
```

**Windows:**
```bash
netstat -ano | findstr :8000
taskkill /PID <进程ID> /F
```

### Q3: 统计结果不准确?

**可能原因:**
- PDF 文档存在扫描图片(无法提取文字)
- 文档包含特殊格式或加密内容
- 文件损坏或格式异常

**建议:**
- 确保 PDF 为文本型而非扫描件
- 用原程序打开文档检查是否正常
- 重新保存文档后再次尝试

### Q4: 批量上传时部分文件失败?

**常见原因:**
- 文件名包含特殊字符
- 文档已损坏无法打开
- 格式不在支持范围内

**解决方法:**
- 查看文件列表中的"状态"列
- 失败的文件会标注错误信息
- 单独处理有问题的文件

### Q5: 如何关闭程序?

**打包应用:**
- 直接关闭应用窗口
- macOS 可在 Dock 栏右键退出

**源码运行:**
- 关闭浏览器窗口
- 在终端/命令行按 `Ctrl + C`

---

## 📦 打包说明

本项目支持使用 PyInstaller 打包为独立应用:

**macOS:**
```bash
./打包Mac应用.sh
```

**Windows:**
```bash
打包Windows应用.bat
```

详细打包说明请参考:
- [打包说明.md](打包说明.md)
- [GitHub自动打包指南.md](GitHub自动打包指南.md)

---

## 🔄 GitHub Actions 自动打包

本项目配置了 GitHub Actions 工作流,可在以下情况自动构建:
- 推送代码到 `main` 分支
- 创建新的 tag (如 `v1.0.0`)
- 手动触发工作流

构建产物会自动上传为 Release 附件,详见 [GitHub自动打包指南.md](GitHub自动打包指南.md)

---

## 📄 开源协议

本项目采用 MIT 协议开源,可自由使用、修改和分发。

---

## 🙏 致谢

感谢以下开源项目:
- [FastAPI](https://fastapi.tiangolo.com/) - 现代化 Python Web 框架
- [Vue.js](https://vuejs.org/) - 渐进式 JavaScript 框架
- [Tailwind CSS](https://tailwindcss.com/) - 实用优先的 CSS 框架
- [python-docx](https://python-docx.readthedocs.io/) - Word 文档处理库
- [pdfplumber](https://github.com/jsvine/pdfplumber) - PDF 文本提取工具

---

**祝使用愉快！如有问题或建议,欢迎反馈。** 🎉
